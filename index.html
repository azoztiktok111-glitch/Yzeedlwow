<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg-main: radial-gradient(circle at top, #0b1d2a, #000 60%);
  --accent: #4aa3ff;
}
* { box-sizing:border-box; font-family: "IBM Plex Sans Arabic", system-ui; }

body {
  margin:0;
  min-height:100vh;
  background: var(--bg-main);
  color:#fff;
  transition: background 1s ease;
}

.header {
  position:fixed;
  top:0; width:100%; height:70px;
  padding:10px 16px;
  display:flex; justify-content:space-between; align-items:center;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(14px); z-index:10;
}

.settings-btn {
  width:38px; height:38px; border-radius:50%;
  background: rgba(74,163,255,.15);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition: transform .3s ease;
}
.settings-btn:hover { transform:scale(1.1);}
.settings-btn svg { width:20px;height:20px; fill:var(--accent); transition: fill .5s ease;}

.date-box { text-align:right;}
.date-box .gregorian { font-size:12px; opacity:.6;}
.date-box .hijri { font-size:16px;font-weight:600;}

.app { padding-top:90px; width:95%; max-width:420px; margin:auto;}
.card {
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(18px);
  border-radius:22px;
  padding:26px;
  box-shadow:0 30px 60px rgba(0,0,0,.6);
}

h1 { text-align:center; margin-top:0; font-weight:600;}
.city { text-align:center; opacity:.6; margin-bottom:22px; font-size:14px; }
.time { background: rgba(255,255,255,0.08); border-radius:14px; padding:14px 18px; display:flex; justify-content:space-between; margin-bottom:12px;}
.next { background: rgba(0,0,0,.35); border-radius:16px; padding:16px; text-align:center; margin-bottom:20px;}
.next span { display:block; margin-top:6px; font-size:20px; color: var(--accent); }

/* Modal */
.modal {
  position: fixed; inset:0;
  background: rgba(0,0,0,.7);
  opacity:0; pointer-events:none;
  display:flex; justify-content:center; align-items:center;
  transition:opacity .35s ease; z-index:20;
}
.modal.show { opacity:1; pointer-events:auto;}
.modal-content {
  background:#0c1620;
  width:90%; max-width:350px;
  border-radius:20px;
  padding:22px;
  transform:translateY(-20px);
  transition: transform .4s ease;
}
.modal.show .modal-content { transform:translateY(0);}
.modal-content h3 { text-align:center; margin:0; font-weight:600;}
.version, .label { text-align:center; font-size:12px; color:#888; margin-top:4px;}
.value { text-align:center; font-size:14px; margin-bottom:14px;}
.toggle { display:flex; justify-content:space-between; align-items:center; background: rgba(255,255,255,.05); border-radius:12px; padding:12px 14px; margin-top:10px;}
.toggle input { width:40px; height:20px; cursor:pointer;}
.close { text-align:center; margin-top:18px; color: var(--accent); cursor:pointer; }

/* Bottom nav */
.bottom-nav {
  position:fixed; bottom:0; width:100%; height:60px;
  background: rgba(0,0,0,.55); backdrop-filter: blur(12px);
  display:flex; justify-content:space-around; align-items:center;
  z-index:15;
}
.bottom-nav button {
  background:none; border:none; color:#fff;
  font-size:16px; cursor:pointer;
  opacity:.7; transition: opacity .2s ease;
}
.bottom-nav button.active { opacity:1; color: var(--accent);}
.bottom-nav button:hover { opacity:1;}

/* Sections */
.section { display:none; padding-bottom:70px; }
.section.active { display:block; }
#dhikr-text { text-align:center; font-size:18px; margin:20px;}
#tasbih-count { text-align:center; font-size:32px; margin:20px; }
#tasbih-btn { display:block; margin:20px auto; padding:12px 20px; font-size:18px; border-radius:12px; background: var(--accent); border:none; color:#000; cursor:pointer; }
</style>
</head>

<body>

<div class="header">
  <div class="settings-btn" onclick="openSettings()">
    <svg viewBox="0 0 24 24">
      <path d="M19.14,12.94a7.43,7.43,0,0,0,.05-.94,7.43,7.43,0,0,0-.05-.94l2.11-1.65a.5.5,0,0,0,.12-.63l-2-3.46a.5.5,0,0,0-.6-.22l-2.49,1a7.28,7.28,0,0,0-1.63-.94l-.38-2.65A.5.5,0,0,0,11.78,2H8.22a.5.5,0,0,0-.49.41L7.35,5.06a7.28,7.28,0,0,0-1.63.94l-2.49-1a.5.5,0,0,0-.6.22l-2,3.46a.5.5,0,0,0,.12.63L2.86,11.06a7.43,7.43,0,0,0-.05.94,7.43,7.43,0,0,0,.05.94L0.75,14.59a.5.5,0,0,0-.12.63l2,3.46a.5.5,0,0,0,.6.22l2.49-1a7.28,7.28,0,0,0,1.63.94l.38,2.65a.5.5,0,0,0,.49.41h3.56a.5.5,0,0,0,.49-.41l.38-2.65a7.28,7.28,0,0,0,1.63-.94l2.49,1a.5.5,0,0,0,.6-.22l2-3.46a.5.5,0,0,0-.12-.63ZM10,15.5A3.5,3.5,0,1,1,13.5,12,3.5,3.5,0,0,1,10,15.5Z"/>
    </svg>
  </div>
  <div class="date-box">
    <div class="gregorian" id="gregorian">--</div>
    <div class="hijri" id="hijri">--</div>
  </div>
</div>

<!-- Sections -->
<div id="home" class="section active">
  <div class="app">
    <div class="card">
      <h1>ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</h1>
      <div class="city" id="city">Ø¬Ø§Ø±Ù ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...</div>
      <div class="next">
        Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: <span id="nextPrayer">--</span> | Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="countdown">--:--:--</span>
      </div>
      <div id="times"></div>
    </div>
  </div>
</div>

<div id="dhikr" class="section">
  <div id="dhikr-text">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
  <button onclick="nextDhikr()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<div id="tasbih" class="section">
  <div id="tasbih-count">0</div>
  <button id="tasbih-btn" onclick="addTasbih()">Ø§Ø¶ØºØ·</button>
  <button onclick="resetTasbih()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
</div>

<!-- Modal settings -->
<div class="modal" id="settings">
  <div class="modal-content">
    <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
    <div class="version">v1.5.0</div>
    <div class="label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
    <div class="value" id="location">--</div>
    <div class="toggle">
      <span>ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª 24 Ø³Ø§Ø¹Ø©</span>
      <input type="checkbox" id="timeFormat" onchange="toggleTime()">
    </div>
    <div class="close" onclick="closeSettings()">Ø¥ØºÙ„Ø§Ù‚</div>
  </div>
</div>

<!-- Bottom nav -->
<div class="bottom-nav">
  <button onclick="showSection('home')" class="active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
  <button onclick="showSection('dhikr')">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
  <button onclick="showSection('tasbih')">Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</button>
</div>

<script>
// Ø§Ù„ØµÙˆØª
const openSound = new Audio("https://www.myinstants.com/media/sounds/click.mp3");

// Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØµÙ„ÙˆØ§Øª
const prayerThemes = {
  Fajr:{bg:"radial-gradient(circle at top, #1c3b57,#000 65%)",accent:"#7fc8ff"},
  Dhuhr:{bg:"radial-gradient(circle at top,#1a2e3f,#000 65%)",accent:"#4aa3ff"},
  Asr:{bg:"radial-gradient(circle at top,#202a33,#000 65%)",accent:"#5fa8d3"},
  Maghrib:{bg:"radial-gradient(circle at top,#2a1f3d,#000 65%)",accent:"#b58cff"},
  Isha:{bg:"radial-gradient(circle at top,#0b1320,#000 70%)",accent:"#3b82f6"}
};

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª
let is24h = localStorage.getItem("timeFormat")==="24";
function formatTime(time){
  let [h,m]=time.split(":").map(Number);
  if(is24h) return `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`;
  const period=h>=12?"Ù…":"Øµ"; h=h%12||12;
  return `${h}:${m.toString().padStart(2,"0")} ${period}`;
}
function toggleTime(){
  is24h=document.getElementById("timeFormat").checked;
  localStorage.setItem("timeFormat",is24h?"24":"12");
  document.querySelectorAll(".ptime").forEach(el=>{el.innerText=formatTime(el.dataset.time);});
}

// Ø§Ù„ØªØ§Ø±ÙŠØ®
function updateDates(){
  const now=new Date();
  document.getElementById("gregorian").innerText=now.toLocaleDateString("en-US",{ weekday:"long", day:"numeric", month:"long"});
  document.getElementById("hijri").innerText=now.toLocaleDateString("ar-SA-u-ca-islamic",{ day:"numeric", month:"long", year:"numeric"});
}

// Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© + Ø§Ù„Ø«ÙŠÙ…
function getCurrentPrayer(prayerTimes){
  const now=new Date();
  for(let p in prayerTimes){
    let [h,m]=prayerTimes[p].split(":").map(Number);
    let t=new Date(); t.setHours(h,m,0);
    if(now<t) return p;
  }
  return "Isha";
}
function applyTheme(prayer){
  const theme=prayerThemes[prayer]; if(!theme) return;
  document.documentElement.style.setProperty("--bg-main",theme.bg);
  document.documentElement.style.setProperty("--accent",theme.accent);
}

// Ù…Ø¤Ù‚Øª Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
function updateCountdown(times){
  const now=new Date();
  const nextP = getCurrentPrayer(times);
  const [h,m]=times[nextP].split(":").map(Number);
  const target=new Date(); target.setHours(h,m,0);
  const diff=Math.max(0,target-now);
  const hrs=Math.floor(diff/1000/3600);
  const mins=Math.floor(diff/1000/60)%60;
  const secs=Math.floor(diff/1000)%60;
  document.getElementById("nextPrayer").innerText=nextP;
  document.getElementById("countdown").innerText=`${hrs.toString().padStart(2,"0")}:${mins.toString().padStart(2,"0")}:${secs.toString().padStart(2,"0")}`;
}

// Ø§Ù„Ù…ÙˆÙ‚Ø¹ + Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©
let prayerTimesData={};
navigator.geolocation.getCurrentPosition(pos=>{
  const {latitude,longitude}=pos.coords;
  fetch(`https://api.aladhan.com/v1/timings?latitude=${latitude}&longitude=${longitude}&method=4`)
  .then(r=>r.json()).then(d=>{
    const times=d.data.timings; prayerTimesData=times;
    document.getElementById("city").innerText=d.data.meta.timezone;
    const current=getCurrentPrayer(times); applyTheme(current);
    const c=document.getElementById("times"); c.innerHTML="";
    const prayers={"Fajr":"Ø§Ù„ÙØ¬Ø±","Dhuhr":"Ø§Ù„Ø¸Ù‡Ø±","Asr":"Ø§Ù„Ø¹ØµØ±","Maghrib":"Ø§Ù„Ù…ØºØ±Ø¨","Isha":"Ø§Ù„Ø¹Ø´Ø§Ø¡"};
    for(let p in prayers){
      const t=times[p];
      c.innerHTML+=`<div class="time"><span>${prayers[p]}</span><span class="ptime" data-time="${t}">${formatTime(t)}</span></div>`;
    }
    setInterval(()=>updateCountdown(times),1000);
  });
  fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=ar`)
  .then(r=>r.json()).then(d=>{
    document.getElementById("location").innerText=`${d.city||d.locality}, ${d.countryName}`;
  });
});

// Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
const settings=document.getElementById("settings");
function openSettings(){ openSound.play(); settings.classList.add("show"); }
function closeSettings(){ settings.classList.remove("show"); }

// Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".bottom-nav button").forEach(b=>b.classList.remove("active"));
  document.querySelector(`[onclick="showSection('${id}')"]`).classList.add("active");
}

// Ø§Ù„Ø£Ø°ÙƒØ§Ø±
const dhikrList=["Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡","Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡","Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±","Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡","Ø§Ù„Ù„Ù‡Ù… ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯"];
let dhikrIndex=0;
function nextDhikr(){
  dhikrIndex=(dhikrIndex+1)%dhikrList.length;
  document.getElementById("dhikr-text").innerText=dhikrList[dhikrIndex];
}

// Ø§Ù„Ù…Ø³Ø¨Ø­Ø©
let tasbihCount=Number(localStorage.getItem("tasbih")||0);
document.getElementById("tasbih-count").innerText=tasbihCount;
function addTasbih(){
  tasbihCount++; localStorage.setItem("tasbih",tasbihCount);
  document.getElementById("tasbih-count").innerText=tasbihCount;
}
function resetTasbih(){ tasbihCount=0; localStorage.setItem("tasbih",tasbihCount); document.getElementById("tasbih-count").innerText=tasbihCount; }

// ØªØ­Ù…ÙŠÙ„
updateDates();
setInterval(updateDates,60000);
document.addEventListener("DOMContentLoaded",()=>{ document.getElementById("timeFormat").checked=is24h; });
</script>
</body>
</html>
